import{_ as N}from"./PanelControl-936f1e93.js";import{u as $,b as i,m as u,d as j,o as l,f as E,a as c,w as o,F as B,g as I,c as p,V as q,y as d,Z as r,n as F,j as w,t as O,x as P,s as g,ab as x,a0 as h,a1 as m,aA as Y,aa as Z,a2 as G,Y as H}from"./index-18f30046.js";import{a as y,s}from"./VFooter-1975de81.js";import{V as J}from"./VSelect-3bb82d76.js";import{V as K}from"./VCol-7ed7c233.js";import{V as Q}from"./VRow-99b26c0e.js";import"./VApp-061e3757.js";import"./_commonjsHelpers-725317a4.js";import"./VTextField-ffd46df8.js";import"./form-65142a50.js";import"./VChip-c85d63b7.js";const W={__name:"CardsSolicitudes",setup(L){const f=$();i(["elevated","flat","tonal","outlined","text","plain"]),i("recibidas");const S=i(1),b=i(20);i("");const C=i("Todas"),_=i(f.solicitudes),D=u(()=>V.value.sort((e,a)=>e.miembro<a.miembro?-1:e.miembro>a.miembro?1:0)),V=u(()=>{S.value=1;const e=C.value;return e==="Recibidas"?_.value.filter(a=>a.userReceptor===r.currentUser.email):e==="Enviadas"?_.value.filter(a=>a.userEmisor===r.currentUser.email):_.value.filter(a=>!0)});u(()=>Math.ceil(T.value/b.value));const R=u(()=>{const e=(S.value-1)*b.value,a=e+b.value;return D.value.slice(e,a)}),T=u(()=>V.value.length);j(()=>f.solicitudes,(e,a)=>{_.value=e});async function U(e){await s({title:"¿Seguro que desea cancelar la Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})?(await x(h(m,"Solicitudes",e)),s("Solicitud Cancelada","La solicitud ha sido cancelada con éxito.","success")):s("Operación Cancelada","La solicitud no ha sido cancelada.","info")}async function z(e){await s({title:"¿Seguro que desea rechazar la Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})?(await x(h(m,"Solicitudes",e)),s("Solicitud Rechazada","La solicitud ha sido rechazada con éxito.","success")):s("Operación Cancelada","La solicitud no ha sido rechazada.","info")}async function A(e){if(await s({title:"¿Seguro que desea aceptar esta Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})){const t=h(m,"Membresia",e.miembro),v=await Y(t);v.exists()?(await Z(m,async n=>{const k=v.data().historiaTraslados;k.push({sede:f.data,fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString()}),await G(t,{sede:e.userEmisor,historiaTraslados:k,direccion:"",timestamp:H()}),await M(e.miembro)}),s("Solicitud Aceptada","La solicitud ha sido aceptada con éxito.","success")):(s("Error","No se encontró el documento.","error"),console.log("No such document!"))}else s("Operación Cancelada","La solicitud no ha sido aceptada.","info")}async function M(e){return await x(h(m,"Solicitudes",e))}return(e,a)=>(l(),E("div",null,[c(J,{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=t=>C.value=t),label:"Modo",items:["Todas","Recibidas","Enviadas"],"item-title":"name",style:{width:"150px"}},null,8,["modelValue"]),c(Q,{dense:""},{default:o(()=>[(l(!0),E(B,null,I(R.value,(t,v)=>(l(),p(K,{key:v,cols:"12",md:"4",sm:"5"},{default:o(()=>[c(q,{class:"mx-auto",color:t.userEmisor===d(r).currentUser.email?"#385F73":"#ffffff","max-width":"344",subtitle:"ID:"+t.miembro,title:t.userEmisor===d(r).currentUser.email?"Enviada":"Recibida"},{default:o(()=>[c(F,{style:{"margin-top":"-15px"}},{default:o(()=>[w(O(t.nombre.split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")),1)]),_:2},1024),c(P,{style:{"margin-top":"-20px"}},{default:o(()=>[t.userEmisor==d(r).currentUser.email?(l(),p(y,{key:0,size:"small",variant:"tonal",class:"text-none",slim:"",color:"",onClick:n=>U(t.miembro)},{default:o(()=>[w("Cancelar solicitud")]),_:2},1032,["onClick"])):g("",!0),t.userEmisor!==d(r).currentUser.email?(l(),p(y,{key:1,class:"text-none text-subtitle-1",color:"primary",size:"small",variant:"flat",onClick:n=>A(t)},{default:o(()=>[w(" Confirmar ")]),_:2},1032,["onClick"])):g("",!0),t.userEmisor!==d(r).currentUser.email?(l(),p(y,{key:2,size:"small",variant:"tonal",color:"",class:"ml-1 text-none",onClick:n=>z(t.miembro)},{default:o(()=>[w("Eliminar")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024)]),_:2},1032,["color","subtitle","title"])]),_:2},1024))),128))]),_:1})]))}},ue={__name:"Solicitudes",setup(L){return(f,S)=>(l(),p(N,null,{default:o(()=>[c(W)]),_:1}))}};export{ue as default};
