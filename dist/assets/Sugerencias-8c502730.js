import{_ as F}from"./PanelControl-7df2cc45.js";import{u as B,aU as U,b as a,aV as $,o as c,c as f,w as t,a as o,V as N,k as A,j as h,n as j,ax as q,t as y,s as z,h as D,y as b,f as H,U as P,aW as W,a2 as Z,Z as G}from"./index-90f7fbfb.js";import{a as J,s as E}from"./VFooter-00ceb151.js";import{V as K}from"./VRow-9d2fd381.js";import{V as L}from"./VCol-fcab6052.js";import{V as O}from"./VForm-b35ddd23.js";import{V as Q}from"./VSelect-8aea1f06.js";import{V as X}from"./VTextarea-e9078d95.js";import{V as Y}from"./VAlert-edbd8292.js";import{V as ee}from"./VContainer-cae74a55.js";import"./VApp-187cba23.js";import"./_commonjsHelpers-725317a4.js";import"./form-1a9ccaaf.js";import"./VTextField-cfb14247.js";import"./VChip-254359b9.js";import"./VAlertTitle-e063ad04.js";const ae={style:{width:"100%","text-align":"right"}},te={key:0},v=24*60*60*1e3,re={__name:"FormSugerencias",setup(I){const T=B();U();const i=a(""),l=a(""),s=a(null),k=["Sugerencia","Reportar Error"];var m=localStorage.getItem("ultimaMarcaDeTiempo"),d=a(V(m)),p=a(d.value>=v),u=a(_()),g=a(S(u.value));function x(){return setInterval(()=>{d.value=V(m),p.value=d.value>=v,u.value=_(),g.value=S(u.value)},1e3)}const w=x();function V(e){return e?Date.now()-parseInt(e):1/0}function _(){return Math.max(0,v-d.value)}function S(e){const n=Math.floor(e/1e3)%60,r=Math.floor(e/1e3/60)%60;return`${Math.floor(e/1e3/3600).toString().padStart(2,"0")}:
          ${r.toString().padStart(2,"0")}:
          ${n.toString().padStart(2,"0")}`}const M=()=>{if(!s.value){l.value="Seleccione un tipo de feedback";return}if(i.value.trim()===""){l.value="El comentario no puede estar vacío";return}if(i.value.length>300){l.value="El comentario no puede superar los 300 caracteres";return}if(!p.value){l.value="Debes esperar 24 horas antes de enviar otra sugerencia.";return}localStorage.setItem("ultimaMarcaDeTiempo",Date.now().toString()),R(),i.value="",s.value=null,l.value=""};$(()=>{clearInterval(w)});async function R(){try{const r={tipo:s.value,ms:i.value,user:T.data,timestamp:P()},C=await W(Z(G,"Sugerencias"),r);localStorage.setItem("ultimaMarcaDeTiempo",Date.now().toString()),m=localStorage.getItem("ultimaMarcaDeTiempo");var e=a(V(m)),n=a(e.value>=v);u=a(_()),g=a(S(u.value));const oe=x();E("Exito!","Sugerencia enviada con éxito.","success")}catch(r){E("Error","Hubo un problema al enviar la sugerencia.","error"),console.error("Error al enviar la sugerencia: ",r)}}return(e,n)=>(c(),f(ee,{fluid:""},{default:t(()=>[o(K,{justify:"center"},{default:t(()=>[o(L,{cols:"12",sm:"8",md:"6"},{default:t(()=>[o(N,{color:"#F2F2F2"},{default:t(()=>[o(A,{class:"text-h5"},{default:t(()=>[h("Enviar Sugerencia o Reportar Error")]),_:1}),o(j,null,{default:t(()=>[o(O,{onSubmit:q(M,["prevent"])},{default:t(()=>[o(Q,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=r=>s.value=r),items:k,label:"Tipo de Feedback",required:""},null,8,["modelValue"]),o(X,{modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=r=>i.value=r),label:"Comentario",hint:"Máximo 300 caracteres",counter:300,required:""},null,8,["modelValue"]),l.value?(c(),f(Y,{key:0,type:"error"},{default:t(()=>[h(y(l.value),1)]),_:1})):z("",!0),D("div",ae,[b(p)?(c(),f(J,{key:1,color:"primary",type:"submit",class:"text-right mt-4",disabled:!b(p)},{default:t(()=>[h(" Enviar ")]),_:1},8,["disabled"])):(c(),H("div",te,[D("p",null,"Puedes enviar otra sugerencia en: "+y(b(g)),1)]))])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}},be={__name:"Sugerencias",setup(I){return(T,i)=>(c(),f(F,null,{default:t(()=>[o(re)]),_:1}))}};export{be as default};
