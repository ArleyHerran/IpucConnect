import{_ as $}from"./PanelControl-7df2cc45.js";import{u as N,b as i,m as u,d as j,o as l,f as E,a as c,w as o,F as B,g as I,c as p,V as q,y as d,W as r,n as F,j as w,t as O,x as P,s as g,aa as x,Y as h,Z as m,aA as W,a9 as Y,$ as Z,U as G}from"./index-90f7fbfb.js";import{a as y,s}from"./VFooter-00ceb151.js";import{V as H}from"./VSelect-8aea1f06.js";import{V as J}from"./VCol-fcab6052.js";import{V as K}from"./VRow-9d2fd381.js";import"./VApp-187cba23.js";import"./_commonjsHelpers-725317a4.js";import"./VTextField-cfb14247.js";import"./form-1a9ccaaf.js";import"./VChip-254359b9.js";const Q={__name:"CardsSolicitudes",setup(L){const f=N();i(["elevated","flat","tonal","outlined","text","plain"]),i("recibidas");const S=i(1),C=i(20);i("");const b=i("Todas"),_=i(f.solicitudes),U=u(()=>V.value.sort((e,a)=>e.miembro<a.miembro?-1:e.miembro>a.miembro?1:0)),V=u(()=>{S.value=1;const e=b.value;return e==="Recibidas"?_.value.filter(a=>a.userReceptor===r.currentUser.email):e==="Enviadas"?_.value.filter(a=>a.userEmisor===r.currentUser.email):_.value.filter(a=>!0)});u(()=>Math.ceil(R.value/C.value));const D=u(()=>{const e=(S.value-1)*C.value,a=e+C.value;return U.value.slice(e,a)}),R=u(()=>V.value.length);j(()=>f.solicitudes,(e,a)=>{_.value=e});async function T(e){await s({title:"¿Seguro que desea cancelar la Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})?(await x(h(m,"Solicitudes",e)),s("Solicitud Cancelada","La solicitud ha sido cancelada con éxito.","success")):s("Operación Cancelada","La solicitud no ha sido cancelada.","info")}async function z(e){await s({title:"¿Seguro que desea rechazar la Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})?(await x(h(m,"Solicitudes",e)),s("Solicitud Rechazada","La solicitud ha sido rechazada con éxito.","success")):s("Operación Cancelada","La solicitud no ha sido rechazada.","info")}async function A(e){if(await s({title:"¿Seguro que desea aceptar esta Solicitud?",icon:"warning",buttons:!0,dangerMode:!0})){const t=h(m,"Membresia",e.miembro),v=await W(t);v.exists()?(await Y(m,async n=>{const k=v.data().historiaTraslados;k.push({sede:f.data,fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString()}),await Z(t,{sede:e.userEmisor,historiaTraslados:k,direccion:"",timestamp:G()}),await M(e.miembro)}),s("Solicitud Aceptada","La solicitud ha sido aceptada con éxito.","success")):(s("Error","No se encontró el documento.","error"),console.log("No such document!"))}else s("Operación Cancelada","La solicitud no ha sido aceptada.","info")}async function M(e){return await x(h(m,"Solicitudes",e))}return(e,a)=>(l(),E("div",null,[c(H,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=t=>b.value=t),label:"Modo",items:["Todas","Recibidas","Enviadas"],"item-title":"name",style:{width:"150px"}},null,8,["modelValue"]),c(K,{dense:""},{default:o(()=>[(l(!0),E(B,null,I(D.value,(t,v)=>(l(),p(J,{key:v,cols:"12",md:"4",sm:"5"},{default:o(()=>[c(q,{class:"mx-auto",color:t.userEmisor===d(r).currentUser.email?"#385F73":"#ffffff","max-width":"344",subtitle:"ID:"+t.miembro,title:t.userEmisor===d(r).currentUser.email?"Enviada":"Recibida"},{default:o(()=>[c(F,{style:{"margin-top":"-15px"}},{default:o(()=>[w(O(t.nombre.split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")),1)]),_:2},1024),c(P,{style:{"margin-top":"-20px"}},{default:o(()=>[t.userEmisor==d(r).currentUser.email?(l(),p(y,{key:0,size:"small",variant:"tonal",class:"text-none",slim:"",color:"",onClick:n=>T(t.miembro)},{default:o(()=>[w("Cancelar solicitud")]),_:2},1032,["onClick"])):g("",!0),t.userEmisor!==d(r).currentUser.email?(l(),p(y,{key:1,class:"text-none text-subtitle-1",color:"primary",size:"small",variant:"flat",onClick:n=>A(t)},{default:o(()=>[w(" Confirmar ")]),_:2},1032,["onClick"])):g("",!0),t.userEmisor!==d(r).currentUser.email?(l(),p(y,{key:2,size:"small",variant:"tonal",color:"",class:"ml-1 text-none",onClick:n=>z(t.miembro)},{default:o(()=>[w("Eliminar")]),_:2},1032,["onClick"])):g("",!0)]),_:2},1024)]),_:2},1032,["color","subtitle","title"])]),_:2},1024))),128))]),_:1})]))}},ue={__name:"Solicitudes",setup(L){return(f,S)=>(l(),p($,null,{default:o(()=>[c(Q)]),_:1}))}};export{ue as default};
